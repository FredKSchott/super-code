<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tab.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">

<dom-module id='super-code-group'>
  <template>

    <style include="iron-flex">
      :host {
        display: block;
      }
      paper-tabs,
      paper-toolbar {
        background-color: var(--super-code-tabs-background-color, --paper-blue-grey-900);
      }
      paper-tabs {
        --paper-tabs-selection-bar-color: var(--super-code-tabs-selection-bar-color, red);
        --paper-tabs-selection-bar: {
          height: 4px;
          @apply(--super-code-tabs-selection-bar);
        };
      }
      paper-tab {
        color: #fff;
        --paper-tab-ink: var(--super-code-tabs-ink, #FFF);
        @apply(--super-code-tab);
      }
      iron-pages {
        width: 100%;
        height: 100%;
      }
    </style>

    <div class="tabstrip layout horizontal center">
      <paper-tabs selected="{{_selected}}" class="flex">
        <template is="dom-repeat" items="[[_panels]]">
          <paper-tab>{{_getTabNameForPanel(item)}}</paper-tab>
        </template>
      </paper-tabs>
    </div>

    <div class="layout horizontal">
      <iron-pages selected="[[_selected]]">
        <content id="contentpanels" select="super-code"></content>
      </iron-pages>
    </div>

  </template>

  <script>
  Polymer({
    is: 'super-code-group',
    properties: {},
    attached: function() {
      this._observer =
          Polymer.dom(this.$.contentpanels).observeNodes(function(mutations) {
            this._updatePanels();
          }.bind(this));
      this._selected = 0;
    },
    detached: function() {
      Polymer.dom(this.$.contentpanels).unobserveNodes(this._observer);
    },
    _updatePanels: function() {
      this._panels = Polymer.dom(this.$.contentpanels).getDistributedNodes();
      for (let panel of this._panels) {
        panel.hideHeader();
      }
      console.log(this._panels);
    },
    _getTabNameForPanel: function(panel) {
      return panel.getAttribute('title') || panel.getAttribute('language').toUpperCase();
    }
  });
  </script>
</dom-module>

<!-- <script type="text/javascript" src="super-code-group-init.js"></script> -->
